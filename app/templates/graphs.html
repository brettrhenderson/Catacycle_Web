{% extends "bootstrap/base.html" %}
{% block title %}Oboros{% endblock %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="{{url_for('.static', filename='css/graphs.css')}}">
<link rel="stylesheet" href="{{url_for('.static', filename='css/bootstrap-colorpicker.css')}}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}

{% block scripts %}
{{super()}}
<script src="{{url_for('.static', filename='js/graphs.js')}}"></script>
<script src="{{url_for('.static', filename='js/bootstrap-colorpicker.js')}}"></script>
<script type="text/javascript">
    $(document).ready(setToken("{{ form.csrf_token._value() }}"));
    $(document).ready(addrow({{ rows|tojson }}));
    $(document).ready(clear());
    $(document).ready(submitHandler("{{ form.csrf_token._value() }}"));
</script>
<script>
    $(function () {
        {% for prefix in ['r', 'f'] %}
            {% for i in range(1, rows+1) %}
                $('#{{ prefix }}_color-picker-component{{ i }}').colorpicker({
                    autoInputFallback: false,
                    popover: { placement: 'right' },
                    format: 'hex',
                    extensions: [
                        {
                            name: 'swatches', // extension name to load
                            options: { // extension options
                                colors: {
                                    'black': '#000000',
                                    'gray': 'gray',
                                    'red': 'red',
                                    'blue': 'blue',
                                    'defaultf1': '#4286f4',
                                    'defaultf2': '#e2893b',
                                    'defaultf3': '#de5eed',
                                    'defaultf4': '#dd547d',
                                    'defaultr1': '#82abed',
                                    'defaultr2': '#efb683',
                                    'defaultr3': '#edb2f4',
                                    'defaultr4': '#ef92ae',
                                },
                                namesAsValues: false
                            }
                        }
                    ]
                })
                {% if prefix == 'f' %}
                .on('change', function (e) {
                    $('#r_color-picker-component{{ i }}')
                    .colorpicker('setValue', e.color.api('lighten', '0.50').api('fade', '0.4').toHexString());
                    // .colorpicker('setValue', e.color.api('lighten', '0.50').api('fade', '0.4').api('desaturate', '0.0').toHexString());
                });
                {% else %}
                ;
                {% endif %}
            {% endfor %}
        {% endfor %}
    });
</script>
{% endblock %}

{% block content %}
    <div class="container pb-2 mt-4 mb-2 border-bottom">
        <h1>Catalytic Cycle Generator</h1>
    </div>
    <div class="container-fluid">
        <div class="row d-flex">
            <div class="col-md-2 col-lg-2"></div>
            <div class="col-md-4 col-lg-4 d-flex flex-column align-items-center justify-content-center max-vw-100" style="overflow: auto;">
                <form id="cycle-form"  style="width: 100%;" action="" method="post" nonvalidate>
                    {{ form.hidden_tag() }}
                    <div class="card">
                        <div class="card-header">
                            <ul class="nav nav-tabs card-header-tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#ratestab">Step Rates</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#colorstab">Colors</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#arrowsstyle">Styling</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#fileformat">File Format</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#outsiderxns">Outside Reactions</a>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content">
                                <div class="tab-pane active show" id="ratestab">
                                    <table class="rates-list table table-hover table-striped" style="width:100%">
                                        <thead>
                                            <tr>
                                                {% for header in ['Step', 'Forward Rate', 'Reverse Rate', 'Add Reagent', 'Remove Product'] %}
                                                <th>
                                                    {{ header }}
                                                </th>
                                                {% endfor %}
                                            </tr>
                                        </thead>
                                        <tbody id="rate-body">
                                            {% for i in range(rows) %}
                                            <tr id="row{{ i+1 }}">
                                                <td>{{ i+1 }}</td>
                                                <td><input id="f_rate{{ i+1 }}" class="form-control rate" type="text" name="f_rate{{ i+1 }}" value="{{ form_values["forward_rates"][i] }}"></td>
                                                <td><input id="r_rate{{ i+1 }}" class="form-control rate" type="text" name="r_rate{{ i+1 }}" value="{{ form_values["rev_rates"][i] }}"></td>
                                                <td><div class="pt-2"><input id="is_incoming{{ i+1 }}" name="is_incoming{{ i+1 }}" class="form-control pt-2 income-check" type="checkbox"></div></td>
                                                <td><div class="pt-2"><input id="is_outgoing{{ i+1 }}" name="is_outgoing{{ i+1 }}" class="form-control pt-2 income-check" type="checkbox"></div></td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <button type="button" class="btn btn-outline-primary float-left" id="addrow">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </div>
                                        <div class="col-sm-4 text-center">
                                            <button type="button" class="btn btn-outline-primary" id="clearrates">
                                                Clear All
                                            </button>
                                        </div>
                                        <div class="col-sm-4">
                                            <button type="button" class="btn btn-outline-primary ibtnDel float-right" id="delrow">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="colorstab">
                                    <table class="color-list table table-hover table-striped" style="width:100%">
                                        <thead>
                                            <tr>
                                                {% for header in ['Step', 'Forward Color', 'Reverse Color'] %}
                                                <th>
                                                    {{ header }}
                                                </th>
                                                {% endfor %}
                                            </tr>
                                        </thead>
                                        <tbody id="color-body">
                                            {% for i in range(rows) %}
                                            <tr id="crow{{ i+1 }}">
                                                <td>{{ i+1 }}</td>
                                                <td>
                                                    <div id="f_color-picker-component{{ i+1 }}" class="input-group colorpicker-component">
                                                        <input id="f_color{{ i+1 }}" name="f_color{{ i+1 }}" type="text" value="{{ form_values['fcolours'][i] }}" class="form-control color"/>
                                                        <span class="input-group-append">
                                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                        </span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div id="r_color-picker-component{{ i+1 }}" class="input-group colorpicker-component">
                                                        <input id="r_color{{ i+1 }}" name="r_color{{ i+1 }}" type="text" value="{{ form_values['rcolours'][i] }}" class="form-control color"/>
                                                        <span class="input-group-append">
                                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <button type="button" class="btn btn-outline-primary float-left" id="addcolorrow">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </div>
                                        <div class="col-sm-4 text-center">
                                            <button type="button" class="btn btn-outline-primary" id="clearcolors">
                                                Clear All
                                            </button>
                                        </div>
                                        <div class="col-sm-4">
                                            <button type="button" class="btn btn-outline-primary ibtnDel float-right" id="delcolorrow">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="arrowsstyle">
                                    <div class="form-group">
                                        <label for="scale_type">Scaling:</label>
                                        <select class="form-control" id="scale_type" name="scale_type">
                                            <option>Logarithmic</option>
                                            <option>Linear</option>
                                            <!--<option>Preserve Multiples</option>-->
                                        </select>
                                    </div>
                                    <div class="form-group form-row">
                                        <label class="col-sm-2 col-form-label" for="gap">Gap:</label>
                                        <span class="col-sm-2">
                                            <img src="{{url_for('.static', filename='images/Gap_small.png')}}" alt="small gap"
                                             srcset="{{url_for('.static', filename='images/Gap_small.svg')}}" width="60" height="30">
                                        </span>
                                        <div class="pt-3 col-sm-4">
                                            <input id="gap" name="gap" class="form-control-range slider" type="range" min="0"
                                                   max="50" step="1" value="{{ form_values['gap'] }}">
                                        </div>
                                        <span class="col-sm-2">
                                            <img src="{{url_for('.static', filename='images/Gap_big.png')}}" alt="big gap"
                                             srcset="{{url_for('.static', filename='images/Gap_big.svg')}}" width="60" height="30">
                                        </span>
                                        <div class="col-sm-2">
                                            <input class="form-control" type="text" id="gapval" readonly>
                                        </div>
                                    </div>
                                    <div class="form-group form-row">
                                        <label class="col-sm-2 col-form-label" for="thickness">Thickness:</label>
                                        <span class="col-sm-2">
                                            <img src="{{url_for('.static', filename='images/Thickness_small.png')}}" alt="thin arrow"
                                             srcset="{{url_for('.static', filename='images/Thickness_small.svg')}}" width="60" height="60">
                                        </span>
                                        <div class="pt-3 col-sm-4">
                                            <input id="thickness" name="thickness" class="form-control-range slider" type="range" min="0"
                                                   max="50" step="1" value="{{ form_values['thickness'] }}">
                                        </div>
                                        <span class="col-sm-2">
                                            <img src="{{url_for('.static', filename='images/Thickness_big.png')}}" alt="thick arrow"
                                             srcset="{{url_for('.static', filename='images/Thickness_big.svg')}}" width="60" height="60">
                                        </span>
                                        <div class="col-sm-2">
                                            <input class="form-control" type="text" id="thicknessval" readonly>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="fileformat">
                                    <div class="form-group form-row">
                                        <label class="col-sm-2 col-form-label" for="f_format">Image Format:</label>
                                        <div class="col-sm-4">
                                            <select class="form-control" id="f_format" name="f_format">
                                                <option selected>.svg</option>
                                                <option>.png</option>
                                            </select>
                                        </div>
                                        <div class="col-sm-6"></div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="outsiderxns">
                                    <div class="form-row">
                                        <div class="form-group col-sm-5>
                                             <label for="f_rate_straight">Forward Rate</label>
                                             <input type="text" class="form-control" id="f_rate_straight" name="f_rate_straight" value="{{ form_values["f_rate_straight"] }}">
                                        </div>
                                        <div class="form-group col-sm-5">
                                             <label for="r_rate_straight">Reverse Rate</label>
                                             <input type="text" class="form-control" id="r_rate_straight" name="r_rate_straight" value="{{ form_values["r_rate_straight"] }}">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-sm-5">
                                            <div class="form-check">
                                                <label class="form-check-label" for="incoming_straight">
                                                    Add Reagent
                                                </label>
                                                <input class="form-check-input" type="checkbox" id="incoming_straight" name="incoming_straight">
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-5">
                                            <div class="form-check">
                                                <label class="form-check-label" for="outgoing_straight">
                                                    Remove Product
                                                </label>
                                                <input class="form-check-input" type="checkbox" id="outgoing_straight" name="outgoing_straight">
                                            </div>
                                         </div>
                                    </div>
                                    <div class="form-group form-row">
                                        <div class="form-group col-sm-5>
                                            <label for="f_color_straight">Forward Color</label>
                                            <div id="straight_f_color-picker-component" class="input-group colorpicker-component">
                                                <input id="f_color_straight" name="f_color_straight" type="text" value="{{ form_values['f_color_straight'] }}" class="form-control"/>
                                                <span class="input-group-append">
                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-5">
                                             <label for="r_color_straight">Reverse Color</label>
                                             <div id="straight_r_color-picker-component" class="input-group colorpicker-component">
                                                <input id="r_color_straight" name="r_color_straight" type="text" value="{{ form_values['r_color_straight'] }}" class="form-control"/>
                                                <span class="input-group-append">
                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <input type="submit" class="form-control btn btn-primary" value="Graph">
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-md-6 col-lg-6 d-flex flex-column align-items-center justify-content-start max-vw-100">
                <div id="imageCarousel" class="carousel slide" data-ride="carousel" data-interval="false">
                     <ol class="carousel-indicators">
                          <li data-target="#imageCarousel" data-slide-to="0" class="active"></li>
                          <li data-target="#imageCarousel" data-slide-to="1"></li>
                     </ol>
                     <div class="carousel-inner">
                          <div class="carousel-item active">
                              <img id='graph' class="d-block w-100 img-fluid max-vh-75" src='{{ graph1 }}' alt="Cycle">
                          </div>
                          <div class="carousel-item">
                               <img class="d-block w-100 img-fluid max-vh-75" src='{{ graph1 }}' alt="Straight Arrow">
                          </div>
                     </div>
                     <a class="carousel-control-prev" href="#imageCarousel" role="button" data-slide="prev">
                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                          <span class="sr-only">Previous</span>
                     </a>
                     <a class="carousel-control-next" href="#imageCarousel" role="button" data-slide="next">
                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                          <span class="sr-only">Next</span>
                     </a>
                </div>
                <!--<img id='graph' class="img-fluid max-vh-75" src='{{ graph1 }}'></img>-->
                <div>
                    <a class="btn btn-primary" href="#">Press Me!</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="page-footer font-small bg-secondary pt-4">

        <!-- Footer Links -->
        <div class="container text-center text-md-left">

          <!-- Grid row -->
          <div class="row">

            <!-- Grid column -->
            <div class="col-md-8 mx-auto">

              <!-- Content -->
              <h5 class="font-weight-bold text-uppercase mt-3 mb-4">About the Site</h5>
              <p>The catalytic cycle generator was created at the University of Victoria under the direction
                  of Professor Scott McIndoe.  It is meant to be a smooth web interface to generate repeatable and
                  standardized visualizations of the rates of various steps in a catalytic cycle. The generated graphic
                  may be saved for annotation by the user to represent their chemistry.
              </p>

            </div>
            <!-- Grid column -->

            <hr class="clearfix w-100 d-md-none">

            <!-- Grid column -->
            <div class="col-md-4 mt-3">

              <!-- Links -->
              <a class="vertCenter btn btn-info"href="#">Contact Form</a>

            </div>
            <!-- Grid column -->

          </div>
          <!-- Grid row -->

        </div>
        <!-- Footer Links -->

        <hr>

        <!-- Social buttons -->
        <div class="wrapper">
            <ul class="social-icons icon-circle list-unstyled list-inline">
                <li>
                    <a href="https://twitter.com/mcindoe?lang=en" class="btn">
                        <i class="fa fa-twitter"> </i>
                    </a>
                </li>
                <li>
                    <a href="https://ca.linkedin.com/in/scottmcindoe" class="btn">
                        <i class="fa fa-linkedin"> </i>
                    </a>
                </li>
                <li class="ml-3">
                    <a href="http://web.uvic.ca/~mcindoe/" class="btn btn-dark">
                        McIndoe Group
                    </a>
                </li>
            </ul>
        </div>
        <!-- Social buttons -->
        <div class="footer-copyright text-center py-3">Copyright placeholder:
          <a href="#"> None</a>
        </div>
        <!-- Copyright
        <div class="footer-copyright text-center py-3">© 2018 Copyright:
          <a href="#"> None</a>
        </div>
        Copyright -->

    </footer>
    <!-- Footer -->

{% endblock %}
